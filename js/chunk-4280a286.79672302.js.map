{"version":3,"sources":["webpack:///./src/views/front/pay/Checkout.vue","webpack:///./src/views/front/pay/components/CheckoutForm.vue","webpack:///./src/utils/vee-validate-schema.js","webpack:///./src/views/front/pay/components/CheckoutForm.vue?1c8b","webpack:///./src/views/front/pay/Checkout.vue?9fba","webpack:///./node_modules/core-js/modules/es.string.trim.js","webpack:///./src/views/front/pay/Checkout.vue?cc82","webpack:///./src/views/front/pay/components/PayStep.vue","webpack:///./src/views/front/pay/components/PayStep.vue?a434","webpack:///./node_modules/core-js/internals/string-trim-forced.js","webpack:///./src/api/coupon.js","webpack:///./src/api/order.js"],"names":["class","style","_createElementVNode","type","placeholder","disabled","_createVNode","_component_GoBanner","title","_component_PayStep","_component_Loading","active","$setup","is-full-page","_hoisted_5","_createElementBlock","_Fragment","_renderList","carts","item","key","id","product","imageUrl","_toDisplayString","qty","_ctx","total","$event","onClick","_hoisted_14","Math","round","final_total","_component_CheckoutForm","for","role","_createBlock","_component_Form","ref","autocomplete","validation-schema","onSubmit","errors","_hoisted_1","_hoisted_3","_component_Field","name","user","email","_component_ErrorMessage","_hoisted_7","tel","message","_hoisted_10","address","_hoisted_12","as","payment_method","method","value","_hoisted_13","_hoisted_15","cols","rows","_hoisted_16","mobile","test","components","Form","Field","ErrorMessage","setup","methods","form","reactive","mySchema","姓名","schema","地址","付款方式","router","useRouter","formRef","submitOrder","validate","valid","createOrder","data","Message","text","resetForm","push","orderId","__exports__","PayStep","CheckoutForm","isLoading","isDiscount","store","useStore","dispatch","then","code","useDiscount","trim","useCoupon","response","cartData","computed","state","cart","render","$","$trim","forcedStringTrimMethod","target","proto","forced","this","_component_GoSteps","$props","_component_GoStepsItem","props","activeIndex","Number","default","PROPER_FUNCTION_NAME","PROPER","fails","whitespaces","non","module","exports","METHOD_NAME","path","process","getCoupons","page","request","createCoupon","coupon","updateCoupon","deleteCoupon","order","getOrderById","payOrder","getOrdersList","updateOrder","deleteOrder","clearOrder"],"mappings":"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","file":"js/chunk-4280a286.79672302.js","sourcesContent":["<template>\r\n  <GoBanner title=\"shop\">結帳流程</GoBanner>\r\n  <div class=\"container mt-3\">\r\n    <!-- 進度 -->\r\n    <PayStep />\r\n    <!-- 購物車內容 & 資料填寫 -->\r\n    <div\r\n      class=\"row g-0 bg-white rounded justify-content-between flex-md-row-reverse p-3 mt-4 mb-4 shadow-sm\"\r\n      style=\"position: relative\"\r\n    >\r\n      <!-- loading 元件 -->\r\n      <Loading :active=\"isLoading\" :is-full-page=\"false\" />\r\n      <div class=\"col-md-6 col-lg-5 px-3 mt-3\">\r\n        <h2 class=\"h2 mb-3\">訂單明細</h2>\r\n        <ul class=\"list-unstyled\">\r\n          <li\r\n            class=\"d-flex align-items-center mb-4\"\r\n            v-for=\"item in cartData.carts\"\r\n            :key=\"item.id\"\r\n          >\r\n            <div\r\n              class=\"bg-img\"\r\n              :style=\"{\r\n                'background-image': `url(${item.product.imageUrl})`\r\n              }\"\r\n            ></div>\r\n            <div class=\"col px-3 d-flex\">\r\n              <div class=\"col-7 pe-2\">\r\n                <p class=\"ellipsis m-0\">{{ item.product.title }}</p>\r\n                <small class=\"text-muted\">數量：{{ item.qty }}</small>\r\n              </div>\r\n              <div class=\"col-5 ls-1 text-end\">\r\n                NT$ {{ $currency(item.total) }}\r\n              </div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n        <div class=\"input-group mb-4\">\r\n          <input\r\n            type=\"text\"\r\n            class=\"form-control p-2\"\r\n            placeholder=\"已套用優惠\"\r\n            disabled\r\n            v-if=\"isDiscount\"\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            class=\"form-control p-2\"\r\n            placeholder=\"輸入折扣碼\"\r\n            v-model=\"code\"\r\n            v-else\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-sm btn-primary px-3\"\r\n            :disabled=\"isDiscount\"\r\n            @click=\"useDiscount\"\r\n          >\r\n            使用優惠券\r\n          </button>\r\n        </div>\r\n        <p class=\"text-primary text-end\" v-if=\"!isDiscount\">\r\n          總金額：NT$ <span class=\"fs-4\">{{ $currency(cartData.total) }}</span>\r\n        </p>\r\n        <div v-else class=\"text-end\">\r\n          <small class=\"fs-7 text-muted\">\r\n            總金額：NT$ {{ $currency(cartData.total) }}\r\n          </small>\r\n          <p class=\"text-primary\">\r\n            折扣後金額：\r\n            <span class=\"fs-4 text-success\"\r\n              >NT${{ $currency(Math.round(cartData.final_total)) }}</span\r\n            >\r\n          </p>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-md-6 border rounded p-3\">\r\n        <CheckoutForm />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { computed, ref } from 'vue'\r\nimport PayStep from './components/PayStep.vue'\r\nimport CheckoutForm from './components/CheckoutForm.vue'\r\nimport { useStore } from 'vuex'\r\nimport Message from '@/components/library/Message'\r\nimport { useCoupon } from '@/api/coupon'\r\nexport default {\r\n  name: 'Checkout',\r\n  components: { PayStep, CheckoutForm },\r\n  setup() {\r\n    const isLoading = ref(true)\r\n    const isDiscount = ref(false)\r\n\r\n    // 取得購物車資訊\r\n    const store = useStore()\r\n    store.dispatch('cart/findCart').then(() => {\r\n      isLoading.value = false\r\n    })\r\n\r\n    // 套用折扣碼\r\n    const code = ref('')\r\n    const useDiscount = async () => {\r\n      if (code.value.trim() === '') return Message({ text: '請先輸入折扣碼' })\r\n      try {\r\n        const data = await useCoupon({ code: code.value })\r\n        Message({ type: 'success', text: data.message })\r\n        isDiscount.value = true\r\n      } catch (err) {\r\n        Message({ type: 'error', text: err.response.data.message })\r\n      }\r\n    }\r\n\r\n    return {\r\n      isLoading,\r\n      isDiscount,\r\n      cartData: computed(() => store.state.cart.cartData),\r\n      code,\r\n      useDiscount\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.bg-img {\r\n  width: 80px;\r\n  height: 80px;\r\n  background-size: cover;\r\n  background-position: center center;\r\n  background-repeat: no-repeat;\r\n  overflow: hidden;\r\n}\r\n</style>\r\n","<template>\r\n  <Form\r\n    ref=\"formRef\"\r\n    class=\"col-10 mx-auto\"\r\n    autocomplete=\"off\"\r\n    :validation-schema=\"schema\"\r\n    v-slot=\"{ errors }\"\r\n    @submit=\"submitOrder\"\r\n  >\r\n    <h2 class=\"h2 mb-3\">請填寫訂購人資訊</h2>\r\n    <div class=\"mb-3\">\r\n      <label for=\"email\" class=\"form-label\">\r\n        Email<span class=\"text-danger\">*</span>\r\n      </label>\r\n      <Field\r\n        id=\"email\"\r\n        name=\"email\"\r\n        type=\"email\"\r\n        class=\"form-control\"\r\n        :class=\"{ 'is-invalid': errors['email'] }\"\r\n        placeholder=\"請輸入 Email\"\r\n        v-model=\"form.user.email\"\r\n      />\r\n      <ErrorMessage name=\"email\" class=\"invalid-feedback\"></ErrorMessage>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <label for=\"name\" class=\"form-label\">\r\n        收件人姓名<span class=\"text-danger\">*</span>\r\n      </label>\r\n      <Field\r\n        id=\"name\"\r\n        name=\"姓名\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        :class=\"{ 'is-invalid': errors['姓名'] }\"\r\n        placeholder=\"請輸入姓名\"\r\n        v-model=\"form.user.name\"\r\n      />\r\n      <ErrorMessage name=\"姓名\" class=\"invalid-feedback\"></ErrorMessage>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <label for=\"tel\" class=\"form-label\">\r\n        收件人電話<span class=\"text-danger\">*</span>\r\n      </label>\r\n      <Field\r\n        id=\"tel\"\r\n        name=\"mobile\"\r\n        type=\"tel\"\r\n        class=\"form-control\"\r\n        :class=\"{ 'is-invalid': errors['mobile'] }\"\r\n        placeholder=\"請輸入手機號碼\"\r\n        v-model=\"form.user.tel\"\r\n      />\r\n      <ErrorMessage name=\"mobile\" v-slot=\"{ message }\">\r\n        <span role=\"alert\" class=\"invalid-feedback\">{{ message }}</span>\r\n      </ErrorMessage>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <label for=\"address\" class=\"form-label\">\r\n        收件人地址<span class=\"text-danger\">*</span>\r\n      </label>\r\n      <Field\r\n        id=\"address\"\r\n        name=\"地址\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        :class=\"{ 'is-invalid': errors['地址'] }\"\r\n        placeholder=\"請輸入地址\"\r\n        v-model=\"form.user.address\"\r\n      />\r\n      <ErrorMessage name=\"地址\" class=\"invalid-feedback\"></ErrorMessage>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <label for=\"address\" class=\"form-label\">\r\n        請選擇付款方式<span class=\"text-danger\">*</span>\r\n      </label>\r\n      <Field\r\n        as=\"select\"\r\n        name=\"付款方式\"\r\n        class=\"form-select\"\r\n        :class=\"{ 'is-invalid': errors['付款方式'] }\"\r\n        v-model=\"form.user.payment_method\"\r\n      >\r\n        <option :value=\"method\" v-for=\"method in methods\" :key=\"method\">\r\n          {{ method }}\r\n        </option>\r\n      </Field>\r\n      <ErrorMessage name=\"付款方式\" class=\"invalid-feedback\"></ErrorMessage>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <label for=\"message\" class=\"form-label\">留言</label>\r\n      <textarea\r\n        id=\"message\"\r\n        class=\"form-control\"\r\n        cols=\"30\"\r\n        rows=\"10\"\r\n        v-model=\"form.message\"\r\n      ></textarea>\r\n    </div>\r\n    <div class=\"text-end\">\r\n      <button type=\"submit\" class=\"btn btn-danger\">送出訂單</button>\r\n    </div>\r\n  </Form>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, ref } from 'vue'\r\nimport { createOrder } from '@/api/order'\r\nimport schema from '@/utils/vee-validate-schema'\r\nimport { Form, Field, ErrorMessage } from 'vee-validate'\r\nimport Message from '@/components/library/Message'\r\nimport { useRouter } from 'vue-router'\r\nexport default {\r\n  name: 'CheckoutForm',\r\n  components: { Form, Field, ErrorMessage },\r\n  setup() {\r\n    const methods = ['信用卡', 'ATM轉帳', '取貨付款']\r\n    // 表單資料物件\r\n    const form = reactive({\r\n      user: {\r\n        name: '',\r\n        email: '',\r\n        tel: '',\r\n        address: '',\r\n        payment_method: ''\r\n      },\r\n      message: ''\r\n    })\r\n\r\n    const mySchema = {\r\n      姓名: 'required',\r\n      email: 'required|email',\r\n      mobile: schema.mobile,\r\n      地址: 'required',\r\n      付款方式: 'required'\r\n    }\r\n\r\n    // 送出並生成訂單方法\r\n    const router = useRouter()\r\n    const formRef = ref(null)\r\n    const submitOrder = async () => {\r\n      // 提交訂單前先進行全體驗證\r\n      const valid = await formRef.value.validate()\r\n      if (valid) {\r\n        try {\r\n          const data = await createOrder(form)\r\n          Message({ type: 'success', text: data.message })\r\n\r\n          // 重置表單\r\n          formRef.value.resetForm()\r\n          form.message = ''\r\n\r\n          // 跳轉至付款頁\r\n          router.push(`/checkout/${data.orderId}`)\r\n        } catch (err) {\r\n          Message({ text: '購物車裡面沒有東西唷~' })\r\n        }\r\n      }\r\n    }\r\n\r\n    return { form, methods, schema: mySchema, formRef, submitOrder }\r\n  }\r\n}\r\n</script>\r\n","// 給 vee-validate 提供驗證規則函式\r\nexport default {\r\n  mobile(value) {\r\n    if (!value) return '請輸入手機號碼'\r\n    // 規則: 09開頭, 任意8個數字結尾\r\n    if (!/^09\\d{8}$/.test(value)) return '手機格式不正確'\r\n    return true\r\n  }\r\n}\r\n","import { render } from \"./CheckoutForm.vue?vue&type=template&id=cbb74e0c\"\nimport script from \"./CheckoutForm.vue?vue&type=script&lang=js\"\nexport * from \"./CheckoutForm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\小羊\\\\Desktop\\\\igo-shop\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Checkout.vue?vue&type=template&id=4bf099b5&scoped=true\"\nimport script from \"./Checkout.vue?vue&type=script&lang=js\"\nexport * from \"./Checkout.vue?vue&type=script&lang=js\"\n\nimport \"./Checkout.vue?vue&type=style&index=0&id=4bf099b5&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\小羊\\\\Desktop\\\\igo-shop\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4bf099b5\"]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Checkout.vue?vue&type=style&index=0&id=4bf099b5&lang=scss&scoped=true\"","<template>\r\n  <div class=\"pay-step p-3\">\r\n    <GoSteps :active=\"activeIndex\">\r\n      <GoStepsItem title=\"確認訂單\" />\r\n      <GoStepsItem title=\"進行付款\" />\r\n      <GoStepsItem title=\"完成購買\" />\r\n    </GoSteps>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'PayStep',\r\n  props: {\r\n    activeIndex: {\r\n      type: Number,\r\n      default: 1\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./PayStep.vue?vue&type=template&id=518b0f34\"\nimport script from \"./PayStep.vue?vue&type=script&lang=js\"\nexport * from \"./PayStep.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\小羊\\\\Desktop\\\\igo-shop\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","var PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","import request from '@/utils/request'\r\nconst path = `${process.env.VUE_APP_PATH}`\r\n\r\n// 後台 API\r\n/**\r\n * 取得優惠券列表\r\n * @param {Integer} page - 當前頁碼\r\n * @returns Promise\r\n */\r\nexport const getCoupons = (page = 1) => {\r\n  return request(`/api/${path}/admin/coupons?page=${page}`, 'get')\r\n}\r\n\r\n/**\r\n * 新增優惠券\r\n * @param {Object} coupon - 要新增的優惠券\r\n * @returns Promise\r\n */\r\nexport const createCoupon = (coupon) => {\r\n  return request(`/api/${path}/admin/coupon`, 'post', { data: coupon })\r\n}\r\n\r\n/**\r\n * 修改優惠券\r\n * @param {Object} coupon - 要修改的優惠券\r\n * @returns Promise\r\n */\r\nexport const updateCoupon = (coupon) => {\r\n  return request(`/api/${path}/admin/coupon/${coupon.id}`, 'put', { data: coupon })\r\n}\r\n\r\n/**\r\n * 刪除優惠券\r\n * @param {String} id - 要刪除的優惠券ID\r\n * @returns Promise\r\n */\r\nexport const deleteCoupon = (id) => {\r\n  return request(`/api/${path}/admin/coupon/${id}`, 'delete')\r\n}\r\n\r\n// 前台 API\r\n/**\r\n * 使用優惠券\r\n * @param {Object} code - { code: '折扣碼' }\r\n * @returns Promise\r\n */\r\nexport const useCoupon = (code) => {\r\n  return request(`/api/${path}/coupon`, 'post', { data: code })\r\n}\r\n","import request from '@/utils/request'\r\nconst path = `${process.env.VUE_APP_PATH}`\r\n\r\n// 前台 API\r\n/**\r\n * 建立訂單\r\n * @param {Object} order - 訂單資料表單\r\n * @returns Promise\r\n */\r\nexport const createOrder = (order) => {\r\n  return request(`/api/${path}/order`, 'post', { data: order })\r\n}\r\n\r\n/**\r\n * 根據 ID 查詢訂單\r\n * @param {String} orderId - 訂單ID\r\n * @returns Promise\r\n */\r\nexport const getOrderById = (orderId) => {\r\n  return request(`/api/${path}/order/${orderId}`, 'get')\r\n}\r\n\r\n/**\r\n * 付款\r\n * @param {String} orderId - 訂單ID\r\n * @returns Promise\r\n */\r\nexport const payOrder = (orderId) => {\r\n  return request(`/api/${path}/pay/${orderId}`, 'post')\r\n}\r\n\r\n// 後台 API\r\n/**\r\n * 取得後台訂單列表\r\n * @param {Integer} page - 當前頁碼\r\n * @returns Promise\r\n */\r\nexport const getOrdersList = (page = 1) => {\r\n  return request(`/api/${path}/admin/orders?page=${page}`, 'get')\r\n}\r\n\r\n/**\r\n * 修改訂單資訊 (付費狀態、訂購人資訊)\r\n * @param {Object} order - tempOrder\r\n * @returns Promise\r\n */\r\nexport const updateOrder = (order) => {\r\n  return request(`/api/${path}/admin/order/${order.id}`, 'put', { data: order })\r\n}\r\n\r\n/**\r\n * 刪除一筆訂單\r\n * @param {String} id - 訂單ID\r\n * @returns Promise\r\n */\r\nexport const deleteOrder = (id) => {\r\n  return request(`/api/${path}/admin/order/${id}`, 'delete')\r\n}\r\n\r\n/**\r\n * 刪除所有訂單\r\n * @returns Promise\r\n */\r\nexport const clearOrder = () => {\r\n  return request(`/api/${path}/admin/orders/all`, 'delete')\r\n}\r\n"],"sourceRoot":""}