(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4280a286"],{3008:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),n=function(e){return Object(a["pushScopeId"])("data-v-4bf099b5"),e=e(),Object(a["popScopeId"])(),e},r=Object(a["createTextVNode"])("結帳流程"),o={class:"container mt-3"},l={class:"row g-0 bg-white rounded justify-content-between flex-md-row-reverse p-3 mt-4 mb-4 shadow-sm",style:{position:"relative"}},s={class:"col-md-6 col-lg-5 px-3 mt-3"},i=n((function(){return Object(a["createElementVNode"])("h2",{class:"h2 mb-3"},"訂單明細",-1)})),d={class:"list-unstyled"},u={class:"col px-3 d-flex"},m={class:"col-7 pe-2"},b={class:"ellipsis m-0"},p={class:"text-muted"},O={class:"col-5 ls-1 text-end"},j={class:"input-group mb-4"},f={key:0,type:"text",class:"form-control p-2",placeholder:"已套用優惠",disabled:""},v=["disabled"],V={key:0,class:"text-primary text-end"},N=Object(a["createTextVNode"])(" 總金額：NT$ "),x={class:"fs-4"},g={key:1,class:"text-end"},E={class:"fs-7 text-muted"},h={class:"text-primary"},y=Object(a["createTextVNode"])(" 折扣後金額： "),k={class:"fs-4 text-success"},w={class:"col-md-6 border rounded p-3"};function C(e,t,c,n,C,B){var D=Object(a["resolveComponent"])("GoBanner"),S=Object(a["resolveComponent"])("PayStep"),T=Object(a["resolveComponent"])("Loading"),F=Object(a["resolveComponent"])("CheckoutForm");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(D,{title:"shop"},{default:Object(a["withCtx"])((function(){return[r]})),_:1}),Object(a["createElementVNode"])("div",o,[Object(a["createVNode"])(S),Object(a["createElementVNode"])("div",l,[Object(a["createVNode"])(T,{active:n.isLoading,"is-full-page":!1},null,8,["active"]),Object(a["createElementVNode"])("div",s,[i,Object(a["createElementVNode"])("ul",d,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(n.cartData.carts,(function(t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{class:"d-flex align-items-center mb-4",key:t.id},[Object(a["createElementVNode"])("div",{class:"bg-img",style:Object(a["normalizeStyle"])({"background-image":"url(".concat(t.product.imageUrl,")")})},null,4),Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("p",b,Object(a["toDisplayString"])(t.product.title),1),Object(a["createElementVNode"])("small",p,"數量："+Object(a["toDisplayString"])(t.qty),1)]),Object(a["createElementVNode"])("div",O," NT$ "+Object(a["toDisplayString"])(e.$currency(t.total)),1)])])})),128))]),Object(a["createElementVNode"])("div",j,[n.isDiscount?(Object(a["openBlock"])(),Object(a["createElementBlock"])("input",f)):Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("input",{key:1,type:"text",class:"form-control p-2",placeholder:"輸入折扣碼","onUpdate:modelValue":t[0]||(t[0]=function(e){return n.code=e})},null,512)),[[a["vModelText"],n.code]]),Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-sm btn-primary px-3",disabled:n.isDiscount,onClick:t[1]||(t[1]=function(){return n.useDiscount&&n.useDiscount.apply(n,arguments)})}," 使用優惠券 ",8,v)]),n.isDiscount?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",g,[Object(a["createElementVNode"])("small",E," 總金額：NT$ "+Object(a["toDisplayString"])(e.$currency(n.cartData.total)),1),Object(a["createElementVNode"])("p",h,[y,Object(a["createElementVNode"])("span",k,"NT$"+Object(a["toDisplayString"])(e.$currency(Math.round(n.cartData.final_total))),1)])])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",V,[N,Object(a["createElementVNode"])("span",x,Object(a["toDisplayString"])(e.$currency(n.cartData.total)),1)]))]),Object(a["createElementVNode"])("div",w,[Object(a["createVNode"])(F)])])])],64)}var B=c("1da1"),D=(c("96cf"),c("498a"),c("9501")),S=(c("b0c0"),Object(a["createElementVNode"])("h2",{class:"h2 mb-3"},"請填寫訂購人資訊",-1)),T={class:"mb-3"},F=Object(a["createElementVNode"])("label",{for:"email",class:"form-label"},[Object(a["createTextVNode"])(" Email"),Object(a["createElementVNode"])("span",{class:"text-danger"},"*")],-1),_={class:"mb-3"},$=Object(a["createElementVNode"])("label",{for:"name",class:"form-label"},[Object(a["createTextVNode"])(" 收件人姓名"),Object(a["createElementVNode"])("span",{class:"text-danger"},"*")],-1),R={class:"mb-3"},U=Object(a["createElementVNode"])("label",{for:"tel",class:"form-label"},[Object(a["createTextVNode"])(" 收件人電話"),Object(a["createElementVNode"])("span",{class:"text-danger"},"*")],-1),I={role:"alert",class:"invalid-feedback"},z={class:"mb-3"},M=Object(a["createElementVNode"])("label",{for:"address",class:"form-label"},[Object(a["createTextVNode"])(" 收件人地址"),Object(a["createElementVNode"])("span",{class:"text-danger"},"*")],-1),q={class:"mb-3"},L=Object(a["createElementVNode"])("label",{for:"address",class:"form-label"},[Object(a["createTextVNode"])(" 請選擇付款方式"),Object(a["createElementVNode"])("span",{class:"text-danger"},"*")],-1),P=["value"],G={class:"mb-3"},J=Object(a["createElementVNode"])("label",{for:"message",class:"form-label"},"留言",-1),A=Object(a["createElementVNode"])("div",{class:"text-end"},[Object(a["createElementVNode"])("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function H(e,t,c,n,r,o){var l=Object(a["resolveComponent"])("Field"),s=Object(a["resolveComponent"])("ErrorMessage"),i=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createBlock"])(i,{ref:"formRef",class:"col-10 mx-auto",autocomplete:"off","validation-schema":n.schema,onSubmit:n.submitOrder},{default:Object(a["withCtx"])((function(e){var c=e.errors;return[S,Object(a["createElementVNode"])("div",T,[F,Object(a["createVNode"])(l,{id:"email",name:"email",type:"email",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":c["email"]}]),placeholder:"請輸入 Email",modelValue:n.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.form.user.email=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(s,{name:"email",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",_,[$,Object(a["createVNode"])(l,{id:"name",name:"姓名",type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":c["姓名"]}]),placeholder:"請輸入姓名",modelValue:n.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.form.user.name=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(s,{name:"姓名",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",R,[U,Object(a["createVNode"])(l,{id:"tel",name:"mobile",type:"tel",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":c["mobile"]}]),placeholder:"請輸入手機號碼",modelValue:n.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.form.user.tel=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(s,{name:"mobile"},{default:Object(a["withCtx"])((function(e){var t=e.message;return[Object(a["createElementVNode"])("span",I,Object(a["toDisplayString"])(t),1)]})),_:1})]),Object(a["createElementVNode"])("div",z,[M,Object(a["createVNode"])(l,{id:"address",name:"地址",type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":c["地址"]}]),placeholder:"請輸入地址",modelValue:n.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.form.user.address=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(s,{name:"地址",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",q,[L,Object(a["createVNode"])(l,{as:"select",name:"付款方式",class:Object(a["normalizeClass"])(["form-select",{"is-invalid":c["付款方式"]}]),modelValue:n.form.user.payment_method,"onUpdate:modelValue":t[4]||(t[4]=function(e){return n.form.user.payment_method=e})},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(n.methods,(function(e){return Object(a["openBlock"])(),Object(a["createElementBlock"])("option",{value:e,key:e},Object(a["toDisplayString"])(e),9,P)})),128))]})),_:2},1032,["class","modelValue"]),Object(a["createVNode"])(s,{name:"付款方式",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",G,[J,Object(a["withDirectives"])(Object(a["createElementVNode"])("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=function(e){return n.form.message=e})},null,512),[[a["vModelText"],n.form.message]])]),A]})),_:1},8,["validation-schema","onSubmit"])}var K=c("f8b7"),Q=(c("ac1f"),c("00b4"),{mobile:function(e){return e?!!/^09\d{8}$/.test(e)||"手機格式不正確":"請輸入手機號碼"}}),W=c("7bb1"),X=c("2f59"),Y=c("6c02"),Z={name:"CheckoutForm",components:{Form:W["c"],Field:W["b"],ErrorMessage:W["a"]},setup:function(){var e=["信用卡","ATM轉帳","取貨付款"],t=Object(a["reactive"])({user:{name:"",email:"",tel:"",address:"",payment_method:""},message:""}),c={"姓名":"required",email:"required|email",mobile:Q.mobile,"地址":"required","付款方式":"required"},n=Object(Y["d"])(),r=Object(a["ref"])(null),o=function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(){var c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.value.validate();case 2:if(c=e.sent,!c){e.next=17;break}return e.prev=4,e.next=7,Object(K["b"])(t);case 7:a=e.sent,Object(X["a"])({type:"success",text:a.message}),r.value.resetForm(),t.message="",n.push("/checkout/".concat(a.orderId)),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),Object(X["a"])({text:"購物車裡面沒有東西唷~"});case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(){return e.apply(this,arguments)}}();return{form:t,methods:e,schema:c,formRef:r,submitOrder:o}}},ee=c("6b0d"),te=c.n(ee);const ce=te()(Z,[["render",H]]);var ae=ce,ne=c("5502"),re=c("cbfe"),oe={name:"Checkout",components:{PayStep:D["a"],CheckoutForm:ae},setup:function(){var e=Object(a["ref"])(!0),t=Object(a["ref"])(!1),c=Object(ne["b"])();c.dispatch("cart/findCart").then((function(){e.value=!1}));var n=Object(a["ref"])(""),r=function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(){var c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==n.value.trim()){e.next=2;break}return e.abrupt("return",Object(X["a"])({text:"請先輸入折扣碼"}));case 2:return e.prev=2,e.next=5,Object(re["e"])({code:n.value});case 5:c=e.sent,Object(X["a"])({type:"success",text:c.message}),t.value=!0,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),Object(X["a"])({type:"error",text:e.t0.response.data.message});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return{isLoading:e,isDiscount:t,cartData:Object(a["computed"])((function(){return c.state.cart.cartData})),code:n,useDiscount:r}}};c("5218");const le=te()(oe,[["render",C],["__scopeId","data-v-4bf099b5"]]);t["default"]=le},"498a":function(e,t,c){"use strict";var a=c("23e7"),n=c("58a8").trim,r=c("c8d2");a({target:"String",proto:!0,forced:r("trim")},{trim:function(){return n(this)}})},5051:function(e,t,c){},5218:function(e,t,c){"use strict";c("5051")},9501:function(e,t,c){"use strict";var a=c("7a23"),n={class:"pay-step p-3"};function r(e,t,c,r,o,l){var s=Object(a["resolveComponent"])("GoStepsItem"),i=Object(a["resolveComponent"])("GoSteps");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",n,[Object(a["createVNode"])(i,{active:c.activeIndex},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(s,{title:"確認訂單"}),Object(a["createVNode"])(s,{title:"進行付款"}),Object(a["createVNode"])(s,{title:"完成購買"})]})),_:1},8,["active"])])}c("a9e3");var o={name:"PayStep",props:{activeIndex:{type:Number,default:1}}},l=c("6b0d"),s=c.n(l);const i=s()(o,[["render",r]]);t["a"]=i},c8d2:function(e,t,c){var a=c("5e77").PROPER,n=c("d039"),r=c("5899"),o="​᠎";e.exports=function(e){return n((function(){return!!r[e]()||o[e]()!==o||a&&r[e].name!==e}))}},cbfe:function(e,t,c){"use strict";c.d(t,"c",(function(){return r})),c.d(t,"a",(function(){return o})),c.d(t,"d",(function(){return l})),c.d(t,"b",(function(){return s})),c.d(t,"e",(function(){return i}));c("99af");var a=c("b775"),n="".concat("sheep-api"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Object(a["a"])("/api/".concat(n,"/admin/coupons?page=").concat(e),"get")},o=function(e){return Object(a["a"])("/api/".concat(n,"/admin/coupon"),"post",{data:e})},l=function(e){return Object(a["a"])("/api/".concat(n,"/admin/coupon/").concat(e.id),"put",{data:e})},s=function(e){return Object(a["a"])("/api/".concat(n,"/admin/coupon/").concat(e),"delete")},i=function(e){return Object(a["a"])("/api/".concat(n,"/coupon"),"post",{data:e})}},f8b7:function(e,t,c){"use strict";c.d(t,"b",(function(){return r})),c.d(t,"d",(function(){return o})),c.d(t,"f",(function(){return l})),c.d(t,"e",(function(){return s})),c.d(t,"g",(function(){return i})),c.d(t,"c",(function(){return d})),c.d(t,"a",(function(){return u}));c("99af");var a=c("b775"),n="".concat("sheep-api"),r=function(e){return Object(a["a"])("/api/".concat(n,"/order"),"post",{data:e})},o=function(e){return Object(a["a"])("/api/".concat(n,"/order/").concat(e),"get")},l=function(e){return Object(a["a"])("/api/".concat(n,"/pay/").concat(e),"post")},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Object(a["a"])("/api/".concat(n,"/admin/orders?page=").concat(e),"get")},i=function(e){return Object(a["a"])("/api/".concat(n,"/admin/order/").concat(e.id),"put",{data:e})},d=function(e){return Object(a["a"])("/api/".concat(n,"/admin/order/").concat(e),"delete")},u=function(){return Object(a["a"])("/api/".concat(n,"/admin/orders/all"),"delete")}}}]);
//# sourceMappingURL=chunk-4280a286.79672302.js.map